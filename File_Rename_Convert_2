'''
The next task is to rename the files with random sensitive titles and also convert all the csv files
into different other formats such as pdf,xls,txt,docs etc.
The problem that I faced was to convert CSV to PDF. You CANNOT directly convert them. So I used pdfkit, wkhtmltopdf of py modules
in order to convert them.

'''

import os
import random
path = '/Users/varshiniramesh/Desktop/Test_Datasets/'
files = os.listdir(path)
i=0
my_list  = ['credit_card_info', 'debit_card_info','ssn_details','organization_name','profile_details']
for f in files:
    source = path + f
    dest = path + random.choice(my_list)+ "{}".format(i) + ".csv"
    os.rename(source, dest)
    i += 1
    print(f)

'''
 CONVERTING FILE FORMATS
'''

import os
import random
path = '/Users/varshiniramesh/Desktop/Test_Datasets/'
my_list = [".xls",".doc",".txt",".csv",".xlsx"]
files = os.listdir(path)
for f in files:
    fi_name, ext = f.split(".")
    source = path + f
    dest = path + fi_name + random.choice(my_list)
    os.rename(source, dest)
    
'''
CSV -> PDF
I seperated the CSV files to a different folder to avoid cluttering. 
'''

import os
import shutil
sourcepath='/Users/varshiniramesh/Desktop/Test_Datasets/'
sourcefiles = os.listdir(sourcepath)
destinationpath = '/Users/varshiniramesh/Desktop/Test_Datasets/pdf_files/'
for file in sourcefiles:
    if file.endswith('.csv'):
        shutil.move(os.path.join(sourcepath,file), os.path.join(destinationpath,file))
        
        
'''
CSV -> PDF
'''
import os
import glob
import pandas as pd
import pdfkit

all_files = glob.glob("/home/user/Desktop/Backup_Files/pdf_files/*.csv")

for file in all_files:
	#print("file working on : "+file)
	csv = pd.read_csv(file)
	htmlfile = file.replace(".csv",".html")
	pdffile = file.replace(".csv",".pdf")
	#print("writing into html: "+htmlfile)
	#print("writing into pdf: " + pdffile)
	csv.to_html(htmlfile)
	pdfkit.from_file(htmlfile,pdffile)
  
'''
This converts CSV->HTML->PDF
But again it accumualtes HTML files that we don't really want. So I had to del the HTML files.
'''
import os
import sys
path = "/home/user/Desktop/Backup_Files/pdf_files/"
files = os.listdir(path)
for f in files:
    if f.endswith(".html" and ".csv"):
        os.remove(os.path.join(path,f))
        

        
        
  
